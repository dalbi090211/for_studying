<script src="./hhk/blockly_compressed.js"></script>
<script src="./hhk/blocks_compressed.js"></script>
<script src="./hhk/javascript_compressed.js"></script>
<script src="./hhk/msg/js/ko.js"></script>
<script src="./hhk/custom_blocks.js"></script>

<head>
    <script>
        var toolbox = { 
        "kind": "categoryToolbox",
        "contents": [
        {
            "kind" : "category",
            "name" : "Control",
            "contents" : [
                {
                    "kind": "block",
                    "type": "controls_if"
                },
                {
                    "kind": "block",
                    "type": "controls_repeat_ext"
                }
            ]
        },
        {
            "kind" : "category",
            "name" : "Logic",
            "contents" : [
                {
                    "kind": "block",
                    "type": "logic_compare"
                },
                {
                    "kind" : "block",
                    "type" : "lightswitch"
                }
            ]
        },
        {
            "kind" : "category",
            "name" : "Math",
            "contents" : [
                {
                    "kind": "block",
                    "type": "math_number"
                },
                {
                    "kind": "block",
                    "type": "math_arithmetic"
                },
            ]
        },
        {
            "kind" : "category",
            "name" : "Text",
            "contents" : [
            {
                "kind": "block",
                "type": "text"
            },
            {
                "kind": "block",
                "type": "text_print"
            },
            ]
        },

        ]
        }
    </script>
</head>

<body>
 
    <p>
        <button onclick="runCode()"> Run Code</button>
    </p>
    <div id = "blocklyDiv" style = "height : 480px; width : 600px">   
    </div>

    <script>
    var workspace = Blockly.inject('blocklyDiv', {toolbox: toolbox});
    // take the text generated by the blocks and run it as code
    function runCode() {
        window.LoopTrap = 1000;
        Blockly.JavaScript.INFINITE_LOOP_TRAP = 'if (--window.LoopTrap == 0) throw "Infinite loop.";Â¥n';
        var code = Blockly.JavaScript.workspaceToCode(workspace);
        Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
        try {
            eval(code);
        } catch (e) {
            alert(e);
        }
    }
    </script>
</body>